<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stan Math Library: stan::math::cvodes_integrator&lt; Lmm &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../$standoxy.css" rel="stylesheet" type="text/css">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../stanlogo-main.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://mc-stan.org/math">Stan Math Library</a>
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
   <div id="projectbrief">Automatic Differentiation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d5/d45/classstan_1_1math_1_1cvodes__integrator.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../de/dfe/classstan_1_1math_1_1cvodes__integrator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">stan::math::cvodes_integrator&lt; Lmm &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;int Lmm&gt;<br />
class stan::math::cvodes_integrator&lt; Lmm &gt;</h3>

<p>Integrator interface for CVODES' ODE solvers (Adams &amp; BDF methods). </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Lmm</td><td>ID of ODE solver (1: ADAMS, 2: BDF) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d33/cvodes__integrator_8hpp_source.html#l00028">28</a> of file <a class="el" href="../../d1/d33/cvodes__integrator_8hpp_source.html">cvodes_integrator.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="../../d1/d33/cvodes__integrator_8hpp_source.html">cvodes_integrator.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a500740b3cf1c6974f4aa6e48a34fad0b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d45/classstan_1_1math_1_1cvodes__integrator.html#a500740b3cf1c6974f4aa6e48a34fad0b">cvodes_integrator</a> ()</td></tr>
<tr class="separator:a500740b3cf1c6974f4aa6e48a34fad0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6305af078047fd474daec1886211cc25"><td class="memTemplParams" colspan="2">template&lt;typename F , typename T_initial , typename T_param , typename T_t0 , typename T_ts &gt; </td></tr>
<tr class="memitem:a6305af078047fd474daec1886211cc25"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="../../d8/de1/group__type__trait.html#gacbaff683cd2683209e6855e2c7aaeffe">return_type_t</a>&lt; T_initial, T_param, T_t0, T_ts &gt; &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d5/d45/classstan_1_1math_1_1cvodes__integrator.html#a6305af078047fd474daec1886211cc25">integrate</a> (const char *function_name, const F &amp;f, const std::vector&lt; T_initial &gt; &amp;y0, const T_t0 &amp;t0, const std::vector&lt; T_ts &gt; &amp;ts, const std::vector&lt; T_param &gt; &amp;theta, const std::vector&lt; double &gt; &amp;x, const std::vector&lt; int &gt; &amp;x_int, std::ostream *msgs, double relative_tolerance, double absolute_tolerance, long int max_num_steps)</td></tr>
<tr class="memdesc:a6305af078047fd474daec1886211cc25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the solutions for the specified system of ordinary differential equations given the specified initial state, initial times, times of desired solution, and parameters and data, writing error and warning messages to the specified stream.  <a href="#a6305af078047fd474daec1886211cc25">More...</a><br /></td></tr>
<tr class="separator:a6305af078047fd474daec1886211cc25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a500740b3cf1c6974f4aa6e48a34fad0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a500740b3cf1c6974f4aa6e48a34fad0b">&#9670;&nbsp;</a></span>cvodes_integrator()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int Lmm&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d45/classstan_1_1math_1_1cvodes__integrator.html">stan::math::cvodes_integrator</a>&lt; Lmm &gt;::<a class="el" href="../../d5/d45/classstan_1_1math_1_1cvodes__integrator.html">cvodes_integrator</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d33/cvodes__integrator_8hpp_source.html#l00030">30</a> of file <a class="el" href="../../d1/d33/cvodes__integrator_8hpp_source.html">cvodes_integrator.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6305af078047fd474daec1886211cc25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6305af078047fd474daec1886211cc25">&#9670;&nbsp;</a></span>integrate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int Lmm&gt; </div>
<div class="memtemplate">
template&lt;typename F , typename T_initial , typename T_param , typename T_t0 , typename T_ts &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="../../d8/de1/group__type__trait.html#gacbaff683cd2683209e6855e2c7aaeffe">return_type_t</a>&lt;T_initial, T_param, T_t0, T_ts&gt; &gt; &gt; <a class="el" href="../../d5/d45/classstan_1_1math_1_1cvodes__integrator.html">stan::math::cvodes_integrator</a>&lt; Lmm &gt;::integrate </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>function_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const F &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; T_initial &gt; &amp;&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T_t0 &amp;&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; T_ts &gt; &amp;&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; T_param &gt; &amp;&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream *&#160;</td>
          <td class="paramname"><em>msgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>relative_tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>absolute_tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>max_num_steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the solutions for the specified system of ordinary differential equations given the specified initial state, initial times, times of desired solution, and parameters and data, writing error and warning messages to the specified stream. </p>
<p>This function is templated to allow the initials to be either data or autodiff variables and the parameters to be data or autodiff variables. The autodiff-based implementation for reverse-mode are defined in namespace <code><a class="el" href="../../d4/d84/namespacestan_1_1math.html" title="Matrices and templated mathematical functions. ">stan::math</a></code> and may be invoked via argument-dependent lookup by including their headers.</p>
<p>The solver used is based on the backward differentiation formula which is an implicit numerical integration scheme appropriate for stiff ODE systems.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">F</td><td>type of ODE system function. </td></tr>
    <tr><td class="paramname">T_initial</td><td>type of scalars for initial values. </td></tr>
    <tr><td class="paramname">T_param</td><td>type of scalars for parameters. </td></tr>
    <tr><td class="paramname">T_t0</td><td>type of scalar of initial time point. </td></tr>
    <tr><td class="paramname">T_ts</td><td>type of time-points where ODE solution is returned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">function_name</td><td>name of function for error messages </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>functor for the base ordinary differential equation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y0</td><td>initial state. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t0</td><td>initial time. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ts</td><td>times of the desired solutions, in strictly increasing order, all greater than the initial time. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theta</td><td>parameter vector for the ODE. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>continuous data vector for the ODE. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_int</td><td>integer data vector for the ODE. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">msgs</td><td>the print stream for warning messages. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">relative_tolerance</td><td>relative tolerance passed to CVODE. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">absolute_tolerance</td><td>absolute tolerance passed to CVODE. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_num_steps</td><td>maximal number of admissable steps between time-points </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a vector of states, each state being a vector of the same size as the state variable, corresponding to a time in ts. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">&lt;code&gt;std::domain_error&lt;/code&gt;</td><td>if y0, t0, ts, theta, x are not finite, all elements of ts are not greater than t0, or ts is not sorted in strictly increasing order. </td></tr>
    <tr><td class="paramname">&lt;code&gt;std::invalid_argument&lt;/code&gt;</td><td>if arguments are the wrong size or tolerances or max_num_steps are out of range. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d33/cvodes__integrator_8hpp_source.html#l00081">81</a> of file <a class="el" href="../../d1/d33/cvodes__integrator_8hpp_source.html">cvodes_integrator.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>stan/math/rev/functor/<a class="el" href="../../d1/d33/cvodes__integrator_8hpp_source.html">cvodes_integrator.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->

<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/dce/namespacestan.html">stan</a></li><li class="navelem"><a class="el" href="../../d4/d84/namespacestan_1_1math.html">math</a></li><li class="navelem"><a class="el" href="../../d5/d45/classstan_1_1math_1_1cvodes__integrator.html">cvodes_integrator</a></li>
    <li class="footer">
    <div class="contents" style="font-size:100%;">
      <span style="float:left; margin=0 1em 0 1em;">
      &nbsp;&nbsp;&nbsp;&nbsp;
      [ <a href="http://mc-stan.org/">Stan Home Page</a> ]
      </span>
      <span style="float:right; margin=0 1em 0 1em;">
      <i>&copy; 2011&ndash;2019,
      Stan Development Team.
      &nbsp;&nbsp;&nbsp;&nbsp;
      </i>
      </span>
    </div> </li>
  </ul>
</div>
</body>
</html>
